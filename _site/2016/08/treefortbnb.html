<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>The Priceonomics Data Puzzle: TreefortBnb</title>
    <meta name="description" content="My musings on politics, pop culture, sports, and pretty much anything else I can find data on.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://cmohamma.github.io/2016/08/treefortbnb.html">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Where's the Data?</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">The Priceonomics Data Puzzle: TreefortBnb</h1>
    <p class="post-meta">Aug 12, 2016 • Cyrus M</p>
  </header>

  <article class="post-content">
    <h2 id="which-are-the-most-expensive-cities-in-america-to-book-a-tree-fort">Which Are the Most Expensive Cities in America to Book a Tree Fort?</h2>

<p>It’s the year 2020 and the sharing-economy is in full gear. Everything from hosting city dinners to ride-sharing the great outdoors is fair game. Capitalizing on their own interests and experience, eight-year-old startup prodigees, Sally Hershfield and Felicia Alvarez, have taken the sharing-economy by storm with their ever-growing TreefortBnB enterprise.</p>

<p>Their nascent business venture has become such a hit that industry powerhouse AirBnb has not only taken notice but also action. They’ve identified markets where TreefortBnb has expanded most successfully and it’s been rumored that AirBnb aims to undercut their marketshare by providing incentives that push their users to advertise more competitive prices.</p>

<p>Using data obtained from Priceonomics, I’ve identified the median price of tree fort rentals for the top 100 cities with the most units on the market. Indianapolis IN, Malibu CA, and Park City UT are the most expensive cities in the US to rent a tree fort by median pricing, something AirBnb hopes to use to its own advantage by provding lower cost classical home alternatives.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">##Load dependencies
</span><span class="n">library</span><span class="p">(</span><span class="n">pipeR</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">formattable</span><span class="p">)</span><span class="w">

</span><span class="c1">##URL to download data
</span><span class="n">url</span><span class="o">&lt;-</span><span class="s2">"https://s3.amazonaws.com/pix-media/Data+for+TreefortBnB+Puzzle.csv"</span><span class="w">

</span><span class="c1">#Read in data and aggregate # of units by city and subset to top 100
</span><span class="n">df1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">read.csv</span><span class="p">(</span><span class="n">col.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"City"</span><span class="p">,</span><span class="s2">"State"</span><span class="p">,</span><span class="s2">"Price"</span><span class="p">,</span><span class="s2">"Reviews"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Unit_Sum</span><span class="o">=</span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Unit_Sum</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">head</span><span class="p">(</span><span class="m">100</span><span class="p">)</span><span class="w"> 

</span><span class="c1">#Read in data again and obtain median rental price by city
</span><span class="n">df2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">read.csv</span><span class="p">(</span><span class="n">col.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"City"</span><span class="p">,</span><span class="s2">"State"</span><span class="p">,</span><span class="s2">"Price"</span><span class="p">,</span><span class="s2">"Reviews"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Price_Median</span><span class="o">=</span><span class="n">median</span><span class="p">(</span><span class="n">Price</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Price_Median</span><span class="p">))</span><span class="w"> 

</span><span class="c1">#Merge two data frames
</span><span class="n">df3</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="w"> </span><span class="n">df2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"City"</span><span class="p">,</span><span class="w"> </span><span class="s2">"State"</span><span class="p">),</span><span class="w"> </span><span class="n">all.x</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">all.y</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">df3</span><span class="o">&lt;-</span><span class="n">arrange</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">Price_Median</span><span class="p">))</span><span class="w">

</span><span class="c1">#Rename columns
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df3</span><span class="p">)[</span><span class="m">3</span><span class="p">]</span><span class="o">&lt;-</span><span class="s2">"Unit Total"</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df3</span><span class="p">)[</span><span class="m">4</span><span class="p">]</span><span class="o">&lt;-</span><span class="s2">"Median Price"</span><span class="w">

</span><span class="c1">#Produce output table in html
</span><span class="n">formattable</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
  </span><span class="s1">'Median Price'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_bar</span><span class="p">(</span><span class="s2">"orange"</span><span class="p">)))</span></code></pre></figure>

<table class="table table-condensed">
 <thead>
  <tr>
   <th style="text-align:right;"> City </th>
   <th style="text-align:right;"> State </th>
   <th style="text-align:right;"> Unit Total </th>
   <th style="text-align:right;"> Median Price </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> Indianapolis </td>
   <td style="text-align:right;"> IN </td>
   <td style="text-align:right;"> 251 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 100.00%">650.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Malibu </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 92 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 46.77%">304.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Park City </td>
   <td style="text-align:right;"> UT </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 46.00%">299.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Healdsburg </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 42.31%">275.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Truckee </td>
   <td style="text-align:right;"> NV </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 42.31%">275.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Laguna Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 41.31%">268.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Incline Village </td>
   <td style="text-align:right;"> NV </td>
   <td style="text-align:right;"> 118 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 39.85%">259.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Manhattan Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 55 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 32.15%">209.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Charlotte </td>
   <td style="text-align:right;"> NC </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 30.77%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Napa </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 30.77%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sonoma </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 115 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 30.77%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Austin </td>
   <td style="text-align:right;"> TX </td>
   <td style="text-align:right;"> 2836 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 30.62%">199.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> La Jolla </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 30.00%">195.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sausalito </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 29.23%">190.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Hermosa Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 29.15%">189.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sunny Isles Beach </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 161 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 27.69%">180.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> New York </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 8043 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 26.15%">170.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Beverly Hills </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 74 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 24.62%">160.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Boston </td>
   <td style="text-align:right;"> MA </td>
   <td style="text-align:right;"> 613 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 24.62%">160.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Newport Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 84 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 24.62%">160.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Marina del Rey </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.85%">155.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Venice </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 242 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.85%">155.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Louisville </td>
   <td style="text-align:right;"> KY </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Miami Beach </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 1345 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Mill Valley </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> New Orleans </td>
   <td style="text-align:right;"> LA </td>
   <td style="text-align:right;"> 833 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> San Francisco </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 3622 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Santa Monica </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.08%">150.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Miami </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 640 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 23.00%">149.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Taos </td>
   <td style="text-align:right;"> NM </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 22.85%">148.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sebastopol </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 22.31%">145.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> San Diego </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 986 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 20.00%">130.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Scottsdale </td>
   <td style="text-align:right;"> AZ </td>
   <td style="text-align:right;"> 121 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.85%">129.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Washington </td>
   <td style="text-align:right;"> DC </td>
   <td style="text-align:right;"> 1402 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.85%">129.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> West Hollywood </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.85%">129.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Cambridge </td>
   <td style="text-align:right;"> MA </td>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Charleston </td>
   <td style="text-align:right;"> SC </td>
   <td style="text-align:right;"> 84 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Las Vegas </td>
   <td style="text-align:right;"> NV </td>
   <td style="text-align:right;"> 291 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Naples </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> San Rafael </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 61 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Santa Cruz </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 127 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.23%">125.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Anchorage </td>
   <td style="text-align:right;"> AK </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 19.00%">123.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Brookline </td>
   <td style="text-align:right;"> MA </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 18.46%">120.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Palo Alto </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 18.46%">120.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Santa Rosa </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 18.46%">120.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Hollywood </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 17.77%">115.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Colorado Springs </td>
   <td style="text-align:right;"> CO </td>
   <td style="text-align:right;"> 54 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 17.38%">113.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Davenport </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 108 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 17.38%">113.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Mountain View </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 72 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 17.38%">113.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Brooklyn </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 4368 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.92%">110.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Kissimmee </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 266 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.92%">110.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Los Angeles </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 3236 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.92%">110.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Savannah </td>
   <td style="text-align:right;"> GA </td>
   <td style="text-align:right;"> 91 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.46%">107.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Arlington </td>
   <td style="text-align:right;"> VA </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.38%">106.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Paris </td>
   <td style="text-align:right;"> RI </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.23%">105.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Honolulu </td>
   <td style="text-align:right;"> HI </td>
   <td style="text-align:right;"> 363 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.15%">105.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Alexandria </td>
   <td style="text-align:right;"> VA </td>
   <td style="text-align:right;"> 66 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 16.08%">104.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Berkeley </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 328 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Boulder </td>
   <td style="text-align:right;"> CO </td>
   <td style="text-align:right;"> 265 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Carlsbad </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 54 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Chicago </td>
   <td style="text-align:right;"> IL </td>
   <td style="text-align:right;"> 1255 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Fort Lauderdale </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 151 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Houston </td>
   <td style="text-align:right;"> TX </td>
   <td style="text-align:right;"> 175 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Long Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 113 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Philadelphia </td>
   <td style="text-align:right;"> PA </td>
   <td style="text-align:right;"> 457 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> San Jose </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 104 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Seattle </td>
   <td style="text-align:right;"> WA </td>
   <td style="text-align:right;"> 824 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Somerville </td>
   <td style="text-align:right;"> MA </td>
   <td style="text-align:right;"> 99 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Tampa </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.38%">100.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Pasadena </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.31%">99.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Queens </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 457 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.23%">99.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Ann Arbor </td>
   <td style="text-align:right;"> MI </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.08%">98.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Minneapolis </td>
   <td style="text-align:right;"> MN </td>
   <td style="text-align:right;"> 138 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 15.08%">98.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Long Island City </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 14.69%">95.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Glendale </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.85%">90.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Oakland </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 434 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.85%">90.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Tucson </td>
   <td style="text-align:right;"> AZ </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.85%">90.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Salt Lake City </td>
   <td style="text-align:right;"> UT </td>
   <td style="text-align:right;"> 140 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.77%">89.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Atlanta </td>
   <td style="text-align:right;"> GA </td>
   <td style="text-align:right;"> 302 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.69%">89.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Dallas </td>
   <td style="text-align:right;"> TX </td>
   <td style="text-align:right;"> 114 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.38%">87.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Denver </td>
   <td style="text-align:right;"> CO </td>
   <td style="text-align:right;"> 283 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.23%">86.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Eugene </td>
   <td style="text-align:right;"> OR </td>
   <td style="text-align:right;"> 78 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.08%">85.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Jersey City </td>
   <td style="text-align:right;"> NJ </td>
   <td style="text-align:right;"> 82 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.08%">85.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Madison </td>
   <td style="text-align:right;"> WI </td>
   <td style="text-align:right;"> 59 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.08%">85.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Phoenix </td>
   <td style="text-align:right;"> AZ </td>
   <td style="text-align:right;"> 167 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.08%">85.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Providence </td>
   <td style="text-align:right;"> RI </td>
   <td style="text-align:right;"> 72 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 13.08%">85.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Baltimore </td>
   <td style="text-align:right;"> MD </td>
   <td style="text-align:right;"> 137 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 12.31%">80.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Nashville </td>
   <td style="text-align:right;"> TN </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 12.31%">80.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Pittsburgh </td>
   <td style="text-align:right;"> PA </td>
   <td style="text-align:right;"> 99 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 12.31%">80.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> San Antonio </td>
   <td style="text-align:right;"> TX </td>
   <td style="text-align:right;"> 77 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 12.31%">80.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Portland </td>
   <td style="text-align:right;"> OR </td>
   <td style="text-align:right;"> 819 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 12.15%">79.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Albuquerque </td>
   <td style="text-align:right;"> NM </td>
   <td style="text-align:right;"> 95 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 11.54%">75.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Bronx </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 113 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 11.54%">75.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> New Haven </td>
   <td style="text-align:right;"> CT </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 11.54%">75.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Orlando </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 116 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 11.54%">75.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Silver Spring </td>
   <td style="text-align:right;"> MD </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 11.54%">75.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Cincinnati </td>
   <td style="text-align:right;"> OH </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 10.77%">70.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sacramento </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 10.00%">65.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Durham </td>
   <td style="text-align:right;"> NC </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 9.23%">60.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Raleigh </td>
   <td style="text-align:right;"> NC </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 9.23%">60.0</span> </td>
  </tr>
</tbody>
</table>

<p>Basic listed prices, however, may not reflect <strong>actual</strong> rental costs because not all advertised listings are actually rented out. One way to identify median rental prices for listings that have actually been rented is to subset the data to include only those listings with reviews. The working assumption here is that listings with no reviews may never have actually been rented. For listings with at least one review, Carmel CA, Malibu CA, and Incline Village NV are the most expensive by median rental price.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#Read in data and aggregate # of units by city and subset to top 100
</span><span class="n">df1.b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">read.csv</span><span class="p">(</span><span class="n">col.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"City"</span><span class="p">,</span><span class="s2">"State"</span><span class="p">,</span><span class="s2">"Price"</span><span class="p">,</span><span class="s2">"Reviews"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">Reviews</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1">#subset to only include reviewed listings
</span><span class="w">  </span><span class="n">group_by</span><span class="p">(</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Unit_Sum</span><span class="o">=</span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Unit_Sum</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">head</span><span class="p">(</span><span class="m">100</span><span class="p">)</span><span class="w"> 

</span><span class="c1">#Read in data again and obtain median rental price by city
</span><span class="n">df2.b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">read.csv</span><span class="p">(</span><span class="n">col.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"City"</span><span class="p">,</span><span class="s2">"State"</span><span class="p">,</span><span class="s2">"Price"</span><span class="p">,</span><span class="s2">"Reviews"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">Reviews</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1">#subset to only include reviewed listings
</span><span class="w">  </span><span class="n">group_by</span><span class="p">(</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Price_Median</span><span class="o">=</span><span class="n">median</span><span class="p">(</span><span class="n">Price</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Price_Median</span><span class="p">))</span><span class="w"> 

</span><span class="c1">#Merge two data frames
</span><span class="n">df3.b</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">merge</span><span class="p">(</span><span class="n">df1.b</span><span class="p">,</span><span class="w"> </span><span class="n">df2.b</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"City"</span><span class="p">,</span><span class="w"> </span><span class="s2">"State"</span><span class="p">),</span><span class="w"> </span><span class="n">all.x</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">all.y</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">df3.b</span><span class="o">&lt;-</span><span class="n">arrange</span><span class="p">(</span><span class="n">df3.b</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">Price_Median</span><span class="p">))</span><span class="w">

</span><span class="c1">#Rename columns
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df3.b</span><span class="p">)[</span><span class="m">3</span><span class="p">]</span><span class="o">&lt;-</span><span class="s2">"Unit Total"</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df3.b</span><span class="p">)[</span><span class="m">4</span><span class="p">]</span><span class="o">&lt;-</span><span class="s2">"Median Price"</span><span class="w">

</span><span class="c1">#Produce output table in html
</span><span class="n">df3.b</span><span class="o">&lt;-</span><span class="n">head</span><span class="p">(</span><span class="n">df3.b</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span><span class="n">formattable</span><span class="p">(</span><span class="n">df3.b</span><span class="p">,</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
  </span><span class="s1">'Median Price'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color_bar</span><span class="p">(</span><span class="s2">"orange"</span><span class="p">)))</span></code></pre></figure>

<table class="table table-condensed">
 <thead>
  <tr>
   <th style="text-align:right;"> City </th>
   <th style="text-align:right;"> State </th>
   <th style="text-align:right;"> Unit Total </th>
   <th style="text-align:right;"> Median Price </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> Carmel </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 100.00%">300.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Malibu </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 75.00%">225.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Incline Village </td>
   <td style="text-align:right;"> NV </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 66.67%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Laguna Beach </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 66.67%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Truckee </td>
   <td style="text-align:right;"> NV </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 66.67%">200.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Napa </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 44 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 61.50%">184.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Park City </td>
   <td style="text-align:right;"> UT </td>
   <td style="text-align:right;"> 101 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 59.67%">179.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sunny Isles Beach </td>
   <td style="text-align:right;"> FL </td>
   <td style="text-align:right;"> 98 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 59.17%">177.5</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> Sonoma </td>
   <td style="text-align:right;"> CA </td>
   <td style="text-align:right;"> 92 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 58.33%">175.0</span> </td>
  </tr>
  <tr>
   <td style="text-align:right;"> New York </td>
   <td style="text-align:right;"> NY </td>
   <td style="text-align:right;"> 5597 </td>
   <td style="text-align:right;"> <span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: orange; width: 55.00%">165.0</span> </td>
  </tr>
</tbody>
</table>

<h2 id="lets-map-it">Let’s Map it!</h2>

<p>Let’s see if these rental prices cluster by location across the lower 48 states. Using a function I wrote based on Microsoft’s Bing’s API, I’ve managed to batch geocode the locations provided in the TreefortBnb data file.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#Load Dependencies
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">cowplot</span><span class="p">)</span><span class="w">

</span><span class="c1">#Batch geocode with Bing
</span><span class="n">options</span><span class="p">(</span><span class="n">BingMapsKey</span><span class="o">=</span><span class="s2">"AtquMkrNaB7ME7krIpwQgrTwEqwB0HbUEpRKb9wfpBW-xCbgBzrGabEyUGkdpO0G"</span><span class="p">)</span><span class="w">
</span><span class="n">df3</span><span class="o">$</span><span class="n">Location</span><span class="o">&lt;-</span><span class="n">paste</span><span class="p">(</span><span class="n">df3</span><span class="o">$</span><span class="n">City</span><span class="p">,</span><span class="w"> </span><span class="n">df3</span><span class="o">$</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">", "</span><span class="p">)</span><span class="w">
</span><span class="n">df30</span><span class="o">&lt;-</span><span class="n">t</span><span class="p">(</span><span class="n">geocodeVect</span><span class="p">(</span><span class="n">df3</span><span class="o">$</span><span class="n">Location</span><span class="p">,</span><span class="w"> </span><span class="n">service</span><span class="o">=</span><span class="s2">"bing"</span><span class="p">,</span><span class="w"> </span><span class="n">returntype</span><span class="o">=</span><span class="s2">"coordinates"</span><span class="p">))</span><span class="w">
</span><span class="n">df10</span><span class="o">&lt;-</span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">df30</span><span class="p">)</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df10</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s2">"lat"</span><span class="p">,</span><span class="s2">"lon"</span><span class="p">)</span><span class="w">
</span><span class="n">df3</span><span class="o">&lt;-</span><span class="n">cbind</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span><span class="w"> </span><span class="n">df10</span><span class="p">)</span><span class="w">
</span><span class="n">df3</span><span class="o">&lt;-</span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="w">

</span><span class="c1">#Subset to only include lower 48
</span><span class="n">df3</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">State</span><span class="o">!=</span><span class="s2">"HI"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">State</span><span class="o">!=</span><span class="s2">"AK"</span><span class="p">)</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w"> 

</span><span class="n">states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">map_data</span><span class="p">(</span><span class="s2">"state"</span><span class="p">)</span><span class="w">
</span><span class="n">states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">states</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">states</span><span class="o">$</span><span class="n">order</span><span class="p">),</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_polygon</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span><span class="w">
               </span><span class="n">size</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.75</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="w"> </span><span class="n">`Median Price`</span><span class="p">),</span><span class="w"> 
             </span><span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> 
             </span><span class="n">aes</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="n">`Median Price`</span><span class="p">),</span><span class="w"> 
             </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.line</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">axis.text.x</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">axis.text.y</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">axis.ticks</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">axis.title.x</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">axis.title.y</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">,</span><span class="w">
         </span><span class="n">panel.background</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">panel.border</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">panel.grid.major</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">panel.grid.minor</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
         </span><span class="n">plot.background</span><span class="o">=</span><span class="n">element_blank</span><span class="p">())</span></code></pre></figure>

<p><img src="/cmohamma.github.io/figure/source/2016-08-12-treefortbnb/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" style="display: block; margin: auto 0 auto auto;" /></p>

<p>As a final exercise, let’s compare median AirBnb prices to median TreefortBnb prices. To accomplish that, I’ve scraped data from Priceonomics’s online AirBnb to hotel comparison table. Unfortunately, the data on AirBnb rental prices is not as exhaustive as the data for TreefortBnb (less populated locations are missing for AirBnb), thus, I’ve restricted my analysis to the top 25 most rented locations for TreefortBnb in an effort to increase the overlap between the two samples. Data on AirBnb  rental prices for cities on the TreeforBnb list but not on Priceonomics’s list of AirBnb prices I’ve imputed using data drawn from current averages for each location as shown on AirBnb’s own website (I used this method for 5 cities: Brooklyn, Queens, Kissimmee, Miami Beach, and Santa Monica).</p>

<p>The graph below shows the first difference between TreefortBnb and AirBnb median rental prices across the 25 busiest TreefortBnb cities across the US. Negative values indicate locations where median AirBnb rental prices are more expensive than their TreefortBnb counterparts. Queens, NY (highlighted in red) is the only location where median prices are equivalent, although, median prices in Washington DC, Boulder, CO, and Denver, CO are very close.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load dependencies
</span><span class="n">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">

</span><span class="c1"># Scrape data from site
</span><span class="n">appData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fromJSON</span><span class="p">(</span><span class="s2">"http://priceonomics.com/static/js/hotels/all_data.json"</span><span class="p">)</span><span class="w">

</span><span class="c1"># replicate table
</span><span class="n">data2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">City</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">appData</span><span class="p">),</span><span class="w"> </span><span class="n">Price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">appData</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">air</span><span class="o">$</span><span class="n">apt</span><span class="o">$</span><span class="n">p</span><span class="p">),</span><span class="w"> 
    </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">

</span><span class="c1"># Arrange data
</span><span class="n">setDT</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="w">
</span><span class="n">data2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data2</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">Price</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)]</span><span class="w">
</span><span class="n">data2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Location"</span><span class="p">,</span><span class="w"> </span><span class="s2">"AirPrice"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Subset to only include 25 busiest tree fort markets
</span><span class="n">dddd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df3</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">dddd</span><span class="p">)[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"UnitTotal"</span><span class="w">
</span><span class="n">data3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">dddd</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">UnitTotal</span><span class="p">))</span><span class="w">
</span><span class="n">data3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">)</span><span class="w">

</span><span class="c1"># Imput missing AirBnb values
</span><span class="n">data4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span><span class="w"> </span><span class="n">data2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Location"</span><span class="p">,</span><span class="w"> </span><span class="n">all.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">all.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="o">$</span><span class="n">AirPrice</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">AirPrice</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="p">[</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">104</span><span class="w">
</span><span class="n">data4</span><span class="p">[</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">172</span><span class="w">
</span><span class="n">data4</span><span class="p">[</span><span class="m">13</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">158</span><span class="w">
</span><span class="n">data4</span><span class="p">[</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">99</span><span class="w">
</span><span class="n">data4</span><span class="p">[</span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">141</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">data4</span><span class="p">)[</span><span class="m">5</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"PriceMedian"</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="o">$</span><span class="n">PriceMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">PriceMedian</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="o">$</span><span class="n">AirPrice</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">AirPrice</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate first difference
</span><span class="n">data4</span><span class="o">$</span><span class="n">first_diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data4</span><span class="o">$</span><span class="n">PriceMedian</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">data4</span><span class="o">$</span><span class="n">AirPrice</span><span class="w">  </span><span class="c1">#Negative value 
# mean AirBnb more expensive - positive means TreefortBnb is more
# expensive
</span><span class="w">
</span><span class="c1"># Create variable distinguishing neg from pos values of 1st difference
</span><span class="n">data4</span><span class="o">$</span><span class="n">abs_first_diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">first_diff</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="o">$</span><span class="n">Air_pricier</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">first_diff</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">data4</span><span class="o">$</span><span class="n">Air_pricier</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">Air_pricier</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot
</span><span class="n">library</span><span class="p">(</span><span class="n">cowplot</span><span class="p">)</span><span class="w">  </span><span class="c1">#theme
</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">first_diff</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">data4</span><span class="o">$</span><span class="n">Air_pricier</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"darkgrey"</span><span class="p">),</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data4</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Location</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">first_diff</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Air_pricier</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"First Difference"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> 
    </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"darkgrey"</span><span class="p">,</span><span class="w"> </span><span class="s2">"darkblue"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">panel.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span></code></pre></figure>

<p><img src="/cmohamma.github.io/figure/source/2016-08-12-treefortbnb/unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" style="display: block; margin: auto;" /></p>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Where's the Data?</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Where's the Data?</li>
          <li><a href="mailto:cmohamma@gmail.com">cmohamma@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/cmohamma">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">cmohamma</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">My musings on politics, pop culture, sports, and pretty much anything else I can find data on.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
